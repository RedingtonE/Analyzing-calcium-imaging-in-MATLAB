# Analyzing-calcium-imaging-in-MATLAB

Most people are comfortable with the idea of recording electrical activity from the brain; however, there is a second method of recording neural activity from the brain that takes advantage of chemical changes that occur in active neurons. In recent years scientists have developed a family of proteins that enable optical recording of individual neurons. These proteins are known as calcium indicators. Like the name suggests, a calcium indicator is sensitive to the amount of calcium that is present in a cell expressing the protein. When the concentration of calcium inside of the cell increases the fluorescence activity of the cell also increases, and when the concentration of calcium decreases so too does the fluorescence. This enables researchers like me to image the fluorescence activity of neurons near the surface of the brain. Once these videos are obtained I process them using a series of registration algorithms, bandpass filtering, and finally constrained non-negative matrix factorization to identify individual neurons in the video. Once these steps are completed we can track the fluorescence of individual neurons using the masks of the identified neurons and the video of the brain. Below is an example field of view in black and white with the individual neurons overlaid in green. 

![Example image of calcium data](https://github.com/RedingtonE/Analyzing-calcium-imaging-in-MATLAB/blob/master/examplefieldofview.png)

This algorithm is a small piece of the workflow that's used to generate data from videos and then analyze it to generate novel insights into how the brain functions. This code assumes that the input video has already been registered and filtered, and that a matrix of input neurons (masks) has already been generated. Using this input the function genFBGforNMF from this repository will isolate average fluorescence and background traces and use them to identify calcium transients. An example of the output calcium activity is provided below: 

![Example calcium trace](https://github.com/RedingtonE/Analyzing-calcium-imaging-in-MATLAB/blob/master/Examplethresholdingofaninvidualneuron.png)

In this data we can see a noisy baseline along with calcium transients. The calcium transients are characterized by a sudden increase in fluorescence intensity followed by a slow exponential decay to baseline. An efficient was of identifying calcium transients is estimating the background of the signal, and then setting a threshold (the orange line). Periods of time where the fluorescence intensity can then be further inspected to see if the meet certain temporal criteria. 
